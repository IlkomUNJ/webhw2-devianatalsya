<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bloom - Seller Dashboard</title>
  <link rel="stylesheet" href="/seller.css" />
</head>
<body>

  <section class="dashboard">
  <div class="dashboard-header">
    <h1></h1>
    <form action="/logout" method="POST" style="margin:0;">
      {{ csrfField() }}
      <button type="submit" class="logout-btn">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"/>
        </svg>
        Logout
      </button>
    </form>
  </div>
  
  <h1>Seller Dashboard</h1>

  <div class="add-product">
    <h2>Add New Product</h2>
    <form action="/seller/add-product" method="POST" enctype="multipart/form-data">
      {{ csrfField() }}
      <input type="text" name="name" placeholder="Product name" required />
      <input type="number" name="price" placeholder="Price (without $)" required />
      <input type="file" name="image" accept="image/*" id="imageInput" required />
      <img id="preview" class="preview-img"/>
      <input type="text" name="seller" placeholder="Seller name" />
      <button type="submit">Add Product</button>
    </form>
  </div>

  <div class="product-list">
    <h2>Your Products</h2>
    @if(products.length)
      <table>
        <thead>
          <tr>
            <th>Product</th>
            <th>Image</th>
            <th>Price</th>
            <th>Seller</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @each(product in products)
            <tr>
              <td>{{ product.name }}</td>
              <td><img src="/{{ product.images }}" width="80" /></td>
              <td>{{ product.price }}</td>
              <td>{{ product.seller }}</td>
              <td>
                <form
                  action="/seller/delete-product/{{ product.id }}"
                  method="POST"
                  onsubmit="return confirm('Yakin hapus produk ini?')"
                  style="display:inline;"
                >
                  {{ csrfField() }}
                  <button type="submit" class="delete-btn">Delete</button>
                </form>
              </td>
            </tr>
          @endeach
        </tbody>
      </table>
    @else
      <p>No products yet.</p>
    @endif
  </div>

  <div class="wishlist-section">
    <h2>Buyer Wishlist</h2>
    @if(wishlistData.length)
      <table>
        <thead>
          <tr>
            <th>Product</th>
            <th>Image</th>
            <th>Price</th>
            <th>Seller</th>
            <th>Buyer</th>
          </tr>
        </thead>
        <tbody>
          @each(item in wishlistData)
            <tr>
              <td>{{ item.name }}</td>
              <td><img src="/{{ item.images }}" width="80" /></td>
              <td>{{ item.price }}</td>
              <td>{{ item.seller }}</td>
              <td>{{ item.buyer }}</td>
            </tr>
          @endeach
        </tbody>
      </table>
    @else
      <p>No one has wishlisted your products yet</p>
    @endif
  </div>
</section>

<script>
  const input = document.getElementById("imageInput");
  const preview = document.getElementById("preview");
  input.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file) {
      preview.src = URL.createObjectURL(file);
      preview.style.display = "block";
    } else {
      preview.style.display = "none";
    }
  });
</script>

</body>
</html>
